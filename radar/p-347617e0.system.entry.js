var __awaiter=this&&this.__awaiter||function(t,e,n,i){function o(t){return t instanceof n?t:new n((function(e){e(t)}))}return new(n||(n=Promise))((function(n,r){function a(t){try{l(i.next(t))}catch(e){r(e)}}function s(t){try{l(i["throw"](t))}catch(e){r(e)}}function l(t){t.done?n(t.value):o(t.value).then(a,s)}l((i=i.apply(t,e||[])).next())}))};var __generator=this&&this.__generator||function(t,e){var n={label:0,sent:function(){if(r[0]&1)throw r[1];return r[1]},trys:[],ops:[]},i,o,r,a;return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol==="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(t){return function(e){return l([t,e])}}function l(a){if(i)throw new TypeError("Generator is already executing.");while(n)try{if(i=1,o&&(r=a[0]&2?o["return"]:a[0]?o["throw"]||((r=o["return"])&&r.call(o),0):o.next)&&!(r=r.call(o,a[1])).done)return r;if(o=0,r)a=[a[0]&2,r.value];switch(a[0]){case 0:case 1:r=a;break;case 4:n.label++;return{value:a[1],done:false};case 5:n.label++;o=a[1];a=[0];continue;case 7:a=n.ops.pop();n.trys.pop();continue;default:if(!(r=n.trys,r=r.length>0&&r[r.length-1])&&(a[0]===6||a[0]===2)){n=0;continue}if(a[0]===3&&(!r||a[1]>r[0]&&a[1]<r[3])){n.label=a[1];break}if(a[0]===6&&n.label<r[1]){n.label=r[1];r=a;break}if(r&&n.label<r[2]){n.label=r[2];n.ops.push(a);break}if(r[2])n.ops.pop();n.trys.pop();continue}a=e.call(t,n)}catch(s){a=[6,s];o=0}finally{i=r=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:true}}};System.register(["./p-bda334d9.system.js","./p-dc03120e.system.js","./p-efd827df.system.js","./p-adc488b3.system.js","./p-8acf3331.system.js","./p-be68bc4b.system.js","./p-f8ddaf1f.system.js","./p-f6d2a683.system.js","./p-b4b7d6a2.system.js","./p-430ab16f.system.js","./p-685036c5.system.js"],(function(t){"use strict";var e,n,i,o,r,a,s,l;return{setters:[function(t){e=t.r;n=t.c;i=t.h;o=t.H},function(){},function(){},function(){},function(){},function(){},function(){},function(t){r=t.U},function(){},function(t){a=t.h;s=t.n},function(t){l=t.r}],execute:function(){var c=":host{display:block}.comment{position:relative;background:0 0;margin:.5em 0 0;padding:.5em 0 0;border:none;border-top:none;line-height:1.2}.avatar{display:block;width:2.5em;height:2.5em;float:left;margin:.2em 0 0}.avatar img{display:block;margin:0 auto;width:100%;height:100%;border-radius:.25rem}.author{font-weight:600}.metadata{display:inline-block;margin-left:.5em;color:rgba(0,0,0,.4);font-size:.875em}.metadata>*{display:inline-block;margin:0 .5em 0 0}.content{margin-left:3.5em}.text{margin:.25em 0 .5em;font-size:1em;word-wrap:break-word;color:rgba(0,0,0,.87);line-height:1.3}.actions{font-size:.875em}.actions a{cursor:pointer;display:inline-block;margin:0 .75em 0 0;color:rgba(0,0,0,.4)}.actions a:hover{text-decoration:underline;color:rgba(0,0,0,0.8)}";var u=t("discussion_entry",function(){function t(t){e(this,t);this.allowReply=true;this.allowEdit=false;this.allowDelete=false;this.eventDeleteAnnotation=n(this,"eventDeleteAnnotation",7)}t.prototype.deleteAnnotation=function(t){t.preventDefault();this.eventDeleteAnnotation.emit(this.annotationId)};t.prototype.render=function(){var t=this;return i(o,null,i("slot",null),i("div",{class:"comment",id:this.annotationId},i("div",{class:"avatar"},this.authorImage?i("img",{src:this.authorImage}):""),i("div",{class:"content"},i("a",{class:"author"},this.authorName),i("div",{class:"metadata"},i("span",{class:"published-date"},this.publishedDate)),i("div",{class:"text"},this.description),i("div",{class:"actions"},this.allowReply?i("a",{class:"reply"},"Reply"):"",this.allowDelete?i("a",{class:"delete",onClick:function(e){return t.deleteAnnotation(e)}},"Delete"):""))))};return t}());u.style=c;var h=":host{display:block}.annotation-entry textarea{background:rgba(0, 0, 0, 0) none repeat scroll 0 0;color:#4c4c4c;font-size:1em;min-height:3em;width:80%;padding-left:5px}calcite-button{height:3em}";var d=t("discussion_input",function(){function t(t){e(this,t);this.placeholder="Join the discussion...";this.submit="Share comment";this.eventAddAnnotation=n(this,"eventAddAnnotation",7)}t.prototype.componentWillLoad=function(){return __awaiter(this,void 0,void 0,(function(){var t,e;return __generator(this,(function(n){switch(n.label){case 0:this.session=l();t=r.deserialize(this.session);console.log("Session",this.session);if(!(this.session!==undefined))return[3,2];e=this;return[4,a(JSON.parse(this.session).username,t)];case 1:e.member=n.sent();n.label=2;case 2:return[2]}}))}))};t.prototype.submitAnnotation=function(t){this.error=null;t.preventDefault();if(this.inputEl.value.length===0){return}var e={content:this.inputEl.value,target:this.target,author:this.member.username,createdDate:new Date};this.commitAnnotation(e)};t.prototype.clearAnnotation=function(){this.inputEl.value=""};t.prototype.commitAnnotation=function(t){return __awaiter(this,void 0,void 0,(function(){var e,n;return __generator(this,(function(i){switch(i.label){case 0:e={attributes:Object.assign({target:t.target,description:t.content,created_at:t.createdDate.getTime(),updated_at:t.createdDate.getTime()},t),geometry:t.geometry};return[4,s({url:this.annotationsUrl,features:[e],authentication:r.deserialize(this.session)})];case 1:n=i.sent();if(!!n&&n.addResults[0].success){this.eventAddAnnotation.emit({newAnnotation:t});this.clearAnnotation()}else{this.errorEl.open();this.error=n.addResults[0]["error"].description}return[2]}}))}))};t.prototype.render=function(){var t=this;return i(o,null,i("slot",null),i("div",{class:"annotation-entry"},i("textarea",{placeholder:this.placeholder,ref:function(e){return t.inputEl=e}}),i("br",null),i("calcite-button",{onClick:function(e){return t.submitAnnotation(e)}},this.submit),i("calcite-alert",{ref:function(e){return t.errorEl=e},autoDismiss:true,color:"red",scale:"s"},i("div",{slot:"alert-title"},"There was a problem adding your comment."),i("div",{slot:"alert-message"},this.error))))};return t}());d.style=h}}}));