import{_ as s,a as t}from"./p-ab9e545c.js";import{s as e,c as a}from"./p-25b1b343.js";import{s as o}from"./p-3a912305.js";async function r(r,i){return console.debug("hub-search search: queryParams",[r,i]),void 0===i||void 0!==i&&i.isPortal?await async function(t,o){var r;t.sort=(t.sort||"modified").replace(/name/,"title");let i=[];void 0!==t.q&&0!==(null===(r=t.q)||void 0===r?void 0:r.length)||(t.q="*"),i.push(t.q),t.owner&&i.push("owner:"+t.owner);let n=t.sort,c="asc",l=t.sort.match(/^-/);if(null!==l&&(n=l[1],c="desc"),void 0!==t.customParams&&void 0!==t.customParams.group)return e({groupId:t.customParams.group.id,q:i.join(" AND "),num:t.limit||"10",sortField:n,sortOrder:c,params:{categories:t.customParams.group.categories}}).then(t=>new Promise(e=>{e({results:t.results.map(t=>s({item:t}))})}));if(void 0!==t.groups&&t.groups.length>0){const s=t.groups.map(s=>"group:"+s).join(" OR ");i.push(`(${s})`)}return console.debug("hub-search searchPortal: queryParams",[t,o]),a({q:i.join(" AND "),num:t.limit||"10",sortField:n,sortOrder:c,authentication:null==o?void 0:o.authentication}).then(t=>new Promise(e=>{e({results:t.results.map(t=>s({item:t})),meta:{total:t.total,count:t.num,start:t.start}})}))}(r,i):await async function(s,e){s.sort=(s.sort||"modified").replace(/title/,"name");const a={q:s.q,sort:s.sort,agg:{fields:"tags,collection,owner,source,hasApi,downloadable",size:s.limit}};a.page={key:btoa(JSON.stringify({hub:{start:1,size:s.limit},ago:{start:1,size:s.limit}}))},void 0!==s.groups&&s.groups.length>0&&(a.groupIds=s.groups.join(","));const r=o(a);let i=await fetch(`${e.hubApiUrl}/api/v3/search?${r}`,{});return{results:(await i.json()).data.map(t)}}(r,i)}export{r as s}