import{r as t,h as e,H as o}from"./p-1fd9320b.js";import"./p-0609b493.js";import{m as s,d as r,n as i,g as n,a}from"./p-ae78f844.js";import"./p-2c58a2fe.js";import{a as h}from"./p-0d8b64e7.js";import{U as c}from"./p-6e1507d1.js";import{a as b}from"./p-52b97c29.js";let p={create(t){switch(t){case"portal":return new d;case"hub":return new m}}};class d{constructor(){this.portalUrl="https://www.arcgis.com/share/rest/"}canEdit(t,e){return Promise.all([s(t),r(e)]).then(([t,e])=>t.member.filter(t=>e.groups.includes(t)).length>0)}search(t){return h({q:t})}create(t,e){return i({item:t,authentication:e})}get(t){return Promise.all([n(t),a(t)]).then(([t,e])=>(t.data=e,t))}update(t,e){return new Promise((t,e)=>e(!1))}delete(t){return new Promise((t,e)=>e(!1))}}class m{constructor(){this.hubUrl="https://hub.arcgis.com/api/v3"}canEdit(t,e){return fetch(`${this.hubUrl}/content/${t}`,{method:"GET"}).then(t=>200==t.status)}async search(t){return(await fetch(this.hubUrl+"/search",{method:"GET",body:JSON.stringify(t)})).json()}create(t,e){return delete t.id,delete t.owner,delete t.orgId,i({item:t,authentication:e})}get(t){return Promise.all([n(t),a(t)]).then(([t,e])=>(t.data=e,t))}update(t,e){return new Promise((t,e)=>e(!1))}delete(t){return new Promise((t,e)=>e(!1))}}const l=class{constructor(e){t(this,e),this.item="9cd1f9bdc6794e63ae450087b3b67e05",this.view="preview",this.clientid="WXC842NRBVB6NZ2r",this.portal="https://www.arcgis.com"}componentDidLoad(){"edit"==this.view?this.getEdit():this.getPreview(),p.create("hub").get(this.item).then(t=>{console.log("Notebook",t),this.notebook=t,this.titleEl.innerText=t.title})}getEdit(){const t=`${this.portal}/home/notebook/notebook.html?id=${this.item}`;console.debug("ArcGIS Notebook getEdit",t),this.iFrameEl.src=t}getPreview(){const t=`${this.portal}/sharing/rest/content/items/${this.item}/resources/notebook_preview.json`;console.log("Notebook getPreview",t),fetch(t).then(t=>{t.json().then(t=>{const e=t.html.indexOf("<body>")+6;t.html=t.html.slice(0,e)+"<style>#notebook-container { box-shadow: none; -webkit-box-shadow: none; padding: 0; }</style>"+t.html.slice(e);const o=this.iFrameEl.contentWindow.document;o.open(),o.write(t.html),o.close()})}).catch(t=>{console.error("Error in arcgis-notebook getPreview",t)})}onCopy(t){return b(this.clientid,this.portal).then(t=>(this.session=t,this.copyNotebook()))}copyNotebook(){console.log("onCopy starting",this.notebook),p.create("hub").create(this.notebook,c.deserialize(this.session)).then(t=>{console.log("onCopy Done",t)})}render(){return e(o,null,e("h3",{id:"notebook-title",ref:t=>this.titleEl=t}),e("span",{class:"notebook-title"},e("slot",{name:"title"})),e("hub-button",{class:"notebook-copy-button",color:"dark",text:"Copy Notebook",action:this.onCopy}),e("iframe",{src:"",id:"notebook-iframe",ref:t=>this.iFrameEl=t}))}};l.style=":host{display:block;width:100%;height:100%}iframe{border:none;width:100%;height:100%}.notebook-copy-button{float:right;margin:10px 33px 0 0}.notebook-title{margin-left:33px;float:left}";export{l as arcgis_notebook}