import{_ as e,a as s}from"./p-751e2ca3.js";import{s as t,c as a}from"./p-ae78f844.js";import{s as o}from"./p-0d8b64e7.js";async function r(r,i){return console.debug("hub-search search: queryParams",[r,i]),void 0===i||void 0!==i&&i.isPortal?await async function(s,o){var r;s.sort=(s.sort||"modified").replace(/name/,"title");let i=[];void 0!==s.q&&0!==(null===(r=s.q)||void 0===r?void 0:r.length)||(s.q="*"),i.push(s.q),s.owner&&i.push("owner:"+s.owner);let n=s.sort,c="asc",l=s.sort.match(/^-/);if(null!==l&&(n=l[1],c="desc"),void 0!==s.customParams&&void 0!==s.customParams.group)return t({groupId:s.customParams.group.id,q:i.join(" AND "),num:s.limit||"10",sortField:n,sortOrder:c,params:{categories:s.customParams.group.categories}}).then(s=>new Promise(t=>{t({results:s.results.map(s=>e({item:s}))})}));if(void 0!==s.groups&&s.groups.length>0){const e=s.groups.map(e=>"group:"+e).join(" OR ");i.push(`(${e})`)}return console.debug("hub-search searchPortal: queryParams",[s,o]),a({q:i.join(" AND "),num:s.limit||"10",sortField:n,sortOrder:c,authentication:null==o?void 0:o.authentication}).then(s=>new Promise(t=>{t({results:s.results.map(s=>e({item:s})),meta:{total:s.total,count:s.num,start:s.start}})}))}(r,i):await async function(e,t){e.sort=(e.sort||"modified").replace(/title/,"name");const a={q:e.q,sort:e.sort,agg:{fields:"tags,collection,owner,source,hasApi,downloadable",size:e.limit}};a.page={key:btoa(JSON.stringify({hub:{start:1,size:e.limit},ago:{start:1,size:e.limit}}))},void 0!==e.groups&&e.groups.length>0&&(a.groupIds=e.groups.join(","));const r=o(a);let i=await fetch(`${t.hubApiUrl}/api/v3/search?${r}`,{});return{results:(await i.json()).data.map(s)}}(r,i)}export{r as s}